import pyfiglet
from colorama import init, Fore, Style
import webbrowser
import subprocess
import sys

if sys.platform == "win32":
    import winreg

def get_default_browser_name():
    try:
        with winreg.OpenKey(winreg.HKEY_CURRENT_USER,
                            r"Software\Microsoft\Windows\Shell\Associations\UrlAssociations\http\UserChoice") as key:
            prog_id, _ = winreg.QueryValueEx(key, "ProgId")
            if "ChromeHTML" in prog_id:
                return "Google Chrome"
            elif "FirefoxURL" in prog_id:
                return "Mozilla Firefox"
            elif "MSEdgeHTM" in prog_id:
                return "Microsoft Edge"
            elif "IE.HTTP" in prog_id:
                return "Internet Explorer"
            else:
                return prog_id
    except Exception:
        return "Unknown"

def open_default_browser(url="https://www.google.com"):
    if not (url.startswith("http://") or url.startswith("https://")):
        url = "http://" + url
    webbrowser.open(url)

def open_edge(url=None):
    if sys.platform != "win32":
        return
    try:
        if url:
            subprocess.Popen(["msedge.exe", url])
        else:
            subprocess.Popen(["msedge.exe"])
    except FileNotFoundError:
        edge_path = r"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"
        try:
            if url:
                subprocess.Popen([edge_path, url])
            else:
                subprocess.Popen([edge_path])
        except Exception:
            pass

init()

ascii_art = pyfiglet.figlet_format("QuickNet", font="slant")
print(Fore.GREEN + ascii_art + Style.RESET_ALL)

print(Fore.RED + " --- \\\\ Input NetTools for a list of tools /// ---" + Style.RESET_ALL)

while True:
    user_input = input(Fore.GREEN + "Command: " + Style.RESET_ALL).strip()

    if user_input == "NetTools":
        print(Fore.RED + " --- \\\\ Open Browser /// ---" + Style.RESET_ALL)
        print(Fore.RED + " --- \\\\ View Current Browser --- ///" + Style.RESET_ALL)
        print(Fore.RED + " --- \\\\ Open Edge /// ---" + Style.RESET_ALL)
        print(Fore.RED + " --- \\\\ Open Link /// ---" + Style.RESET_ALL)
        print(Fore.RED + " --- \\\\ Chrome Installation /// ---" + Style.RESET_ALL)
    elif user_input == "Open Browser":
        open_default_browser()
    elif user_input == "View Current Browser":
        browser_name = get_default_browser_name()
        print(Fore.GREEN + browser_name + Style.RESET_ALL)
    elif user_input == "Open Edge":
        open_edge()
    elif user_input == "Open Link":
        link = input(Fore.GREEN + "Go To: " + Style.RESET_ALL).strip()
        if link:
            open_default_browser(link)
    elif user_input == "Chrome Installation":
        chrome_url = "https://www.google.com/chrome/"
        open_edge(chrome_url)
    elif user_input.lower() in ("exit", "quit"):
        break
    else:
        print("Command not recognized.")

input("\nPress Enter to exit...")


